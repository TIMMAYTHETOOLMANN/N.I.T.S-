# ü§ñ AI Investigator Integration

## Overview

The **AI Investigator** is an embedded OpenAI GPT-4 powered intelligence unit integrated into the N.I.T.S. (National Investigation Tracking System) for advanced document analysis. It provides AI-powered detection of SEC, DOJ, IRS, and financial violations with detailed legal citations.

## Features

‚úÖ **GPT-4 Powered Analysis** - Uses OpenAI's GPT-4 model for intelligent document review  
‚úÖ **Legal Statute Citations** - Automatically identifies and cites relevant regulations (e.g., 17 CFR ¬ß 240.10b-5)  
‚úÖ **Violation Detection** - Identifies SEC, DOJ, IRS, and financial compliance violations  
‚úÖ **Severity Assessment** - Provides risk scoring for detected violations  
‚úÖ **Enforcement Recommendations** - Suggests appropriate regulatory actions  
‚úÖ **Markdown Reports** - Generates formatted reports in `./output/` directory

## Installation

### 1. Install Dependencies

```bash
npm install openai dotenv
```

### 2. Configure API Key

Create a `.env` file in the project root:

```bash
# Copy the example file
cp .env.example .env
```

Edit `.env` and add your OpenAI API key:

```
OPENAI_API_KEY=your_openai_api_key_here
```

**Get your API key from:** https://platform.openai.com/api-keys

### 3. Security Note

‚ö†Ô∏è **NEVER commit your `.env` file to git!** The `.env` file is already in `.gitignore` to prevent accidental commits.

## Usage

### Method 1: Programmatic Usage

```typescript
import { IntegratedNITSCore } from './deploy/complete_integration_patch';

async function analyzeDocument() {
  // Initialize NITS Core
  const nits = new IntegratedNITSCore();
  await nits.initialize();

  // Analyze document with AI
  await nits.analyzeUsingAI('./sample_docs/test_document.txt');
  
  // Check ./output/ for the AI report
}
```

### Method 2: Test Script

Run the included test script:

```bash
npx tsx test_ai_investigator.ts
```

### Method 3: GUI Integration

The AI Investigator can be integrated into the GUI by adding a checkbox option "Run AI Investigator" in the upload form.

## API Reference

### `analyzeUsingAI(filePath: string): Promise<void>`

Analyzes a document using the AI Investigator.

**Parameters:**
- `filePath` - Path to the document to analyze

**Output:**
- Generates a markdown report in `./output/ai_<filename>.md`

**Example:**
```typescript
await nits.analyzeUsingAI('./sample_docs/test_document.txt');
// Creates: ./output/ai_test_document.md
```

## Architecture

### File Structure

```
N.I.T.S-/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îî‚îÄ‚îÄ analysis/
‚îÇ       ‚îî‚îÄ‚îÄ AIInvestigator.ts          # AI analysis module
‚îú‚îÄ‚îÄ deploy/
‚îÇ   ‚îî‚îÄ‚îÄ complete_integration_patch.ts  # IntegratedNITSCore with AI method
‚îú‚îÄ‚îÄ .env                               # API keys (not committed)
‚îú‚îÄ‚îÄ .env.example                       # Template for .env
‚îî‚îÄ‚îÄ test_ai_investigator.ts           # Test script
```

### Integration Points

1. **AIInvestigator.ts** - Core AI module using OpenAI SDK
2. **IntegratedNITSCore.analyzeUsingAI()** - High-level API method
3. **GUI Server** - Can be extended to include AI analysis option

## Output Format

The AI Investigator generates markdown reports with:

- Document metadata (filename, analysis date)
- Detailed violation analysis
- Legal statute citations (17 CFR, 15 U.S.C., etc.)
- Severity assessments
- Recommended enforcement actions

**Example Output:** `./output/ai_test_document.md`

```markdown
# ü§ñ AI INVESTIGATOR REPORT

**Document**: test_document.txt  
**Analysis Date**: 2024-01-15T10:30:00.000Z  
**System**: NITS AI Investigator (GPT-4)

---

## AI Analysis Results

[GPT-4 generated analysis with violations and citations]

---

*Report generated by NITS AI Investigator powered by OpenAI GPT-4*
```

## Configuration

### Environment Variables

- `OPENAI_API_KEY` - Your OpenAI API key (required)
- `GOVINFO_API_KEY` - GovInfo API key (optional, defaults to demo key)

### AI Model Settings

Located in `core/analysis/AIInvestigator.ts`:

```typescript
{
  model: 'gpt-4',           // AI model to use
  temperature: 0.1,         // Low temperature for precise analysis
  max_tokens: 2000          // Maximum response length
}
```

## Troubleshooting

### Issue: "API key not found"

**Solution:** 
```bash
# Ensure .env file exists with valid API key
cat .env
# Should show: OPENAI_API_KEY=sk-...
```

### Issue: "Module 'openai' not found"

**Solution:**
```bash
npm install openai dotenv
```

### Issue: "Permission denied writing to output/"

**Solution:**
```bash
mkdir -p output
chmod 755 output
```

## Cost Considerations

- Each document analysis costs ~$0.02-0.10 depending on document size
- GPT-4 pricing: https://openai.com/pricing
- Consider using GPT-3.5-turbo for lower costs (change model in AIInvestigator.ts)

## Security Best Practices

1. ‚úÖ **Never commit API keys** - Use `.env` file (already in `.gitignore`)
2. ‚úÖ **Rotate keys regularly** - Update keys periodically
3. ‚úÖ **Monitor usage** - Check OpenAI dashboard for unexpected usage
4. ‚úÖ **Limit access** - Restrict who has access to the `.env` file

## Testing

Run the test suite:

```bash
# Test AI integration
npx tsx test_ai_investigator.ts

# Verify output
ls -la output/
cat output/ai_test_document.md
```

## Integration with Existing Features

The AI Investigator works alongside existing NITS features:

- ‚úÖ Compatible with **standard document analysis** (TerminatorAnalysisEngine)
- ‚úÖ Compatible with **NLP analysis** (ForensicTextAnalyzer)
- ‚úÖ Compatible with **corpus analysis** (batch processing)
- ‚úÖ Compatible with **GUI** (can be added as option)

## Future Enhancements

Potential improvements:

- [ ] Batch AI analysis for corpus mode
- [ ] GUI integration with "Run AI Investigator" checkbox
- [ ] Streaming responses for large documents
- [ ] Custom system prompts per analysis type
- [ ] Integration with existing violation database

## Support

For issues or questions:
1. Check this README
2. Review `test_ai_investigator.ts` for examples
3. Verify `.env` configuration
4. Check OpenAI API status: https://status.openai.com/

## Mission Status

```
üü¢ AI UNIT: DEPLOYED
üîê KEY: CONFIGURABLE VIA .ENV
ü§ñ EMBEDDED INVESTIGATOR: ONLINE
üìÅ REPORT OUTPUT: ./output/ai_<filename>.md
üß† MODE: GPT-4 PRECISION INTEL
üîÑ INTEGRATED WITH: IntegratedNITSCore.ts
üß™ READY FOR: Document-level analysis
```

---

*NITS AI Investigator - Powered by OpenAI GPT-4*  
*Confidential - For Law Enforcement Use Only*
